#!/bin/bash
set -e

if [ -x ~/.local/bin/mise ]; then
    echo "mise is already installed"
    exit 0
fi

echo "Installing mise with GPG verification..."

# Import mise release GPG key
gpg --keyserver hkps://keys.openpgp.org --recv-keys 24853EC9F655CE80B48E6C3A8B81C9D17413A06D

# Download and verify install script
cd "$(mktemp -d)"
curl -fsSL https://mise.jdx.dev/install.sh.sig | gpg --decrypt > install.sh

# Run installer
sh ./install.sh

echo "mise installed successfully"
